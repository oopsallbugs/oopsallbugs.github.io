var J=Object.defineProperty;var Y=(n,e,t)=>e in n?J(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var z=(n,e,t)=>Y(n,typeof e!="symbol"?e+"":e,t);import{C as ee,u as te,a as K,S as ne,M as se,b as F,j as a,B as ae,d as re,P as oe,A as ie,e as Q,V as le,L as ce,f as pe,O as ue,g as de}from"./three-vendor-B7ZiWQZr.js";import{r as c}from"./router-4KY-5m0q.js";import{L as me}from"./index-CYamVe3m.js";import"./react-vendor-gH-7aFTg.js";const he="_pageWrapper_zvwig_1",fe="_controlsOverlay_zvwig_7",ge="_skyboxLoadingOverlay_zvwig_14",E={pageWrapper:he,controlsOverlay:fe,skyboxLoadingOverlay:ge};class xe{constructor(){z(this,"cache",new Map);z(this,"loadingPromises",new Map);z(this,"cubeLoader",new ee);z(this,"cacheKey","skybox")}async loadCubeTexture(e,t=!1){const s="skybox";if(!t&&this.cache.has(s))return Promise.resolve(this.cache.get(s));if(!t&&this.loadingPromises.has(s))return this.loadingPromises.get(s);const r=new Promise((i,l)=>{this.cubeLoader.load(e,p=>{this.cache.set(s,p),this.loadingPromises.delete(s),i(p)},void 0,p=>{this.loadingPromises.delete(s),l(p)})});return this.loadingPromises.set(s,r),r}setSkybox(e){this.cache.set(this.cacheKey,e)}getSkybox(){return this.cache.get(this.cacheKey)}dispose(){const e=this.cache.get(this.cacheKey);e&&(e.dispose(),this.cache.delete(this.cacheKey))}}const N=new xe,ye=()=>{const e=document.createElement("canvas").getContext("webgl"),t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),s=e?e.getParameter(e.MAX_TEXTURE_SIZE):512,r=s<4096||navigator.hardwareConcurrency<4||"deviceMemory"in navigator&&navigator.deviceMemory<4,l=(navigator.connection||{}).effectiveType;let p,h,m;return l!=="4g"?p="256":p="512",t||r?h="512":h="1024",t?m=2e3:r?m=4e3:m=6e3,{isMobile:t,isLowEnd:r,maxTextureSize:s,preferredParticleCount:m,initialCubemapSize:p,maxCubemapSize:h}},$=ye(),be=({onLoadingStateChange:n,enabled:e})=>{const{scene:t}=te(),s=c.useRef(null);return c.useEffect(()=>{let r=!0;const i=$.initialCubemapSize,l=$.maxCubemapSize,p=[`/cubeMaps/space/${l}/px.png`,`/cubeMaps/space/${l}/nx.png`,`/cubeMaps/space/${l}/py.png`,`/cubeMaps/space/${l}/ny.png`,`/cubeMaps/space/${l}/pz.png`,`/cubeMaps/space/${l}/nz.png`],h=[`/cubeMaps/space/${i}/px.png`,`/cubeMaps/space/${i}/nx.png`,`/cubeMaps/space/${i}/py.png`,`/cubeMaps/space/${i}/ny.png`,`/cubeMaps/space/${i}/pz.png`,`/cubeMaps/space/${i}/nz.png`];return(async()=>{if(!e){t.background=null,t.environment=null,s.current=null;return}const y=N.getSkybox();if(y){t.background=y,t.environment=y,s.current=y,n?.(!1);return}n?.(!0);try{const d=await N.loadCubeTexture(h);if(!r||!e)return;if(t.background=d,t.environment=d,s.current=d,n?.(!1),Number(l)>Number(i))try{const b=await N.loadCubeTexture(p,!0);r&&e&&s.current&&(N.setSkybox(b),t.background=b,t.environment=b,s.current=b)}catch(b){console.warn("Failed to load high quality skybox:",b)}}catch(d){r&&(console.error("Skybox failed to load:",d),n?.(!1))}})(),()=>{r=!1,n?.(!1),t.background=null,t.environment=null,s.current=null,N.dispose()}},[t,n,e]),null},Me=({radius:n,segmentWidth:e,segmentHeight:t,color:s,glow:r,glowIntensity:i,rotationSpeed:l})=>{const p=c.useRef(null),h=c.useRef(new K),m=c.useMemo(()=>new ne(n,e,t),[n,e,t]),y=c.useMemo(()=>new se({color:s,emissive:r,emissiveIntensity:i}),[s,r,i]);return F(()=>{if(p.current){const d=h.current.getDelta();p.current.rotation.y+=d*l}}),c.useRef(()=>()=>{m.dispose(),y.dispose()}),a.jsx("mesh",{ref:p,geometry:m,material:y})},Se=({particleCount:n,size:e,color:t,opacity:s,blackHoleRadius:r,coneAngle:i,radialSpeed:l,spiralSpeed:p,turbulence:h,minDrawRadiusModifier:m,maxDrawRadiusModifier:y})=>{const d=c.useRef(null),b=c.useRef(new K),M=r+.2,S=r+m,C=r+y,o=c.useCallback((g,u)=>{const x=Q.lerp(M,C,Math.random()),P=Math.tan(i)*x,k=(Math.random()*2-1)*P,L=Math.random()*Math.PI*2,I=x*Math.cos(L),O=x*Math.sin(L);g[u]=I,g[u+1]=k,g[u+2]=O},[M,C,i]),f=c.useCallback((g,u)=>{const x=Q.lerp(S,C,Math.random()),P=Math.random()*Math.PI*2,k=Math.tan(i)*x,L=(Math.random()*2-1)*k;g[u]=x*Math.cos(P),g[u+1]=L,g[u+2]=x*Math.sin(P)},[S,C,i]),{geometry:R}=c.useMemo(()=>{const g=new Float32Array(n*3);for(let x=0;x<n;x++)o(g,x*3);const u=new ae;return u.setAttribute("position",new re(g,3)),{geometry:u}},[n,o]),_=c.useMemo(()=>new oe({size:e,color:t,transparent:!0,opacity:s,blending:ie}),[e,t,s]);return F(()=>{if(!d.current)return;const g=b.current.getDelta(),u=d.current.geometry.attributes.position.array;for(let x=0;x<n;x++){const P=x*3,k=u[P],L=u[P+1],I=u[P+2],O=Math.sqrt(k*k+L*L+I*I);if(O<r){f(u,P);continue}const B=1/O,V=-k*B,X=-L*B,Z=-I*B;let A=V*l,U=X*l,W=Z*l,D=-I,H=k;const q=Math.sqrt(D*D+H*H);D/=q,H/=q,A+=D*p,W+=H*p,A+=(Math.random()-.5)*h,U+=(Math.random()-.5)*h,W+=(Math.random()-.5)*h,u[P]+=A*g,u[P+1]+=U*g,u[P+2]+=W*g}d.current.geometry.attributes.position.needsUpdate=!0}),c.useRef(()=>()=>{R.dispose(),_.dispose()}),a.jsx("points",{ref:d,geometry:R,material:_})},Ce=({lineCount:n,spiralRadius:e,distanceToCenter:t,numRotationsToCenter:s,segments:r,spiralSpeed:i,color:l,lineWidth:p,opacity:h})=>{const m=c.useRef(null),y=c.useRef(new K),d=c.useMemo(()=>{const M=[];for(let S=0;S<n;S++){const C=[],o=S/n*Math.PI*2,f=(Math.random()-.5)*2;for(let R=0;R<=r;R++){const _=R/r,g=e*(1-_*t),u=o+_*Math.PI*s,x=f*(1-_)+Math.sin(_*Math.PI*4)*.3*(1-_);C.push(new le(g*Math.cos(u),x,g*Math.sin(u)))}M.push(C)}return M},[n,e,t,s,r]),b=c.useMemo(()=>({color:l,lineWidth:p,transparent:!0,opacity:h,dashed:!1}),[l,p,h]);return F(()=>{if(m.current){const M=y.current.getDelta();m.current.rotation.y-=M*i}}),a.jsx("group",{ref:m,children:d.map((M,S)=>a.jsx(ce,{points:M,...b},S))})},Pe={segmentWidth:32,segmentHeight:32,rotationSpeed:.5},T={radius:{type:"range",min:.1,max:5,step:.1,default:1,name:"Radius"},color:{type:"color",default:"#000000",name:"Color"},glow:{type:"color",default:"#4a0080",name:"Glow"},glowIntensity:{type:"range",min:0,max:2,step:.1,default:.5,name:"Glow Intensity"}},v={lineCount:{type:"range",min:0,max:100,step:1,default:0,name:"Num Lines"},spiralRadius:{type:"range",min:0,max:100,step:1,default:18,name:"Spiral Radius"},distanceToCenter:{type:"range",min:0,max:2,step:.05,default:1,name:"Distance to Center"},numRotationsToCenter:{type:"range",min:0,max:50,step:1,default:8,name:"Num Rotations"},segments:{type:"range",min:2,max:100,step:1,default:150,name:"Segments"},spiralSpeed:{type:"range",min:0,max:5,step:.1,default:.4,name:"Spiral Speed"},color:{type:"color",default:"#6666ff",name:"Line Color"},lineWidth:{type:"range",min:.1,max:3,step:.1,default:1,name:"Line Width"},opacity:{type:"range",min:0,max:1,step:.1,default:.5,name:"Opacity"}},w={particleCount:{type:"range",min:0,max:2e5,step:1e3,default:$.preferredParticleCount,name:"Num Particles"},size:{type:"range",min:.01,max:.2,step:.01,default:.08,name:"Particle Size"},color:{type:"color",default:"#00eeff",name:"Particle Color"},opacity:{type:"range",min:0,max:1,step:.1,default:.7,name:"Particle Opacity"},coneAngle:{type:"range",min:Math.PI/12,max:Math.PI/2,step:Math.PI/60,default:Math.PI/6,name:"Emission Angle"},radialSpeed:{type:"range",min:.001,max:.1,step:.001,default:.025,name:"Radial Speed"},spiralSpeed:{type:"range",min:.01,max:1,step:.01,default:.25,name:"Spiral Speed"},turbulence:{type:"range",min:0,max:.2,step:.01,default:.05,name:"Turbulence"},minDrawRadiusModifier:{type:"range",min:0,max:100,step:1,default:10,name:"Min Draw Radius"},maxDrawRadiusModifier:{type:"range",min:0,max:100,step:1,default:20,name:"Max Draw Radius"}},ve="_controlsWindow_1dxgn_1",we="_blackHoleSphereControls_1dxgn_14",je="_particlesControls_1dxgn_15",Re="_spiralLinesControls_1dxgn_16",_e="_controlsContent_1dxgn_26",ke="_controlGroup_1dxgn_31",Le="_controlLabel_1dxgn_40",Ie="_rangeInput_1dxgn_47",ze="_colorInput_1dxgn_48",j={controlsWindow:ve,blackHoleSphereControls:we,particlesControls:je,spiralLinesControls:Re,controlsContent:_e,controlGroup:ke,controlLabel:Le,rangeInput:Ie,colorInput:ze};function G(n,e,t,s){return e.type==="range"?a.jsxs("div",{className:j.controlGroup,children:[a.jsxs("label",{className:j.controlLabel,children:[e.name,":"]}),a.jsx("input",{type:"range",className:j.rangeInput,min:e.min,max:e.max,step:e.step,value:t,onChange:r=>s(n,parseFloat(r.target.value))})]},String(n)):e.type==="color"?a.jsxs("div",{className:j.controlGroup,children:[a.jsxs("label",{children:[e.name,":"]}),a.jsx("input",{type:"color",className:j.colorInput,value:t,onChange:r=>s(n,r.target.value)})]},String(n)):null}const Ne=({showControls:n,sphereMutableProps:e,onSphereMutablePropsChange:t,spiralLinesProps:s,onSpiralLinesPropsChange:r,particlesProps:i,onParticlesPropsChange:l})=>{const[p,h]=c.useState(!1),[m,y]=c.useState(!1),[d,b]=c.useState(!1),M=(o,f)=>{t({...e,[o]:f})},S=(o,f)=>{r({...s,[o]:f})},C=(o,f)=>{l({...i,[o]:f})};return a.jsx("div",{className:j.controlsWindow,children:n&&a.jsxs("div",{className:j.controlsContent,children:[a.jsx("h3",{onClick:()=>h(o=>!o),children:"Black Hole"}),p&&a.jsx("div",{className:j.blackHoleSphereControls,children:Object.entries(T).map(([o,f])=>G(o,f,e[o],M))}),a.jsx("h3",{onClick:()=>y(o=>!o),children:"Spiral"}),m&&a.jsx("div",{className:j.spiralLinesControls,children:Object.entries(v).map(([o,f])=>G(o,f,s[o],S))}),a.jsx("h3",{onClick:()=>b(o=>!o),children:"Particles"}),d&&a.jsx("div",{className:j.particlesControls,children:Object.entries(w).map(([o,f])=>G(o,f,i[o],C))})]})})};de.enabled=!0;function Te({position:n=[0,0,0],sphereProps:e,spiralLinesProps:t,particlesProps:s}){const r=e.radius;return a.jsxs("group",{position:n,children:[a.jsx(Me,{...e}),a.jsx(Se,{...s,blackHoleRadius:r}),a.jsx(Ce,{...t})]})}const Ae=({controls:n,camera:e,skyBox:t})=>{const[s,r]=c.useState(!1),i={radius:T.radius.default,color:T.color.default,glow:T.glow.default,glowIntensity:T.glowIntensity.default},[l,p]=c.useState(i),m=(R=>({...Pe,...R}))(l),y={lineCount:v.lineCount.default,spiralRadius:v.spiralRadius.default,distanceToCenter:v.distanceToCenter.default,numRotationsToCenter:v.numRotationsToCenter.default,segments:v.segments.default,spiralSpeed:v.spiralSpeed.default,color:v.color.default,lineWidth:v.lineWidth.default,opacity:v.opacity.default},[d,b]=c.useState(y),M=d,S={particleCount:$.preferredParticleCount,size:w.size.default,color:w.color.default,opacity:w.opacity.default,blackHoleRadius:i.radius,coneAngle:w.coneAngle.default,radialSpeed:w.radialSpeed.default,spiralSpeed:w.spiralSpeed.default,turbulence:w.turbulence.default,minDrawRadiusModifier:w.minDrawRadiusModifier.default,maxDrawRadiusModifier:w.maxDrawRadiusModifier.default},[C,o]=c.useState(S),f=C;return a.jsxs("div",{className:E.pageWrapper,children:[a.jsxs(pe,{camera:{position:[4,12,16],fov:75},style:{height:"100%",width:"100%",position:"absolute"},children:[t&&a.jsx(be,{enabled:t,onLoadingStateChange:r}),e&&a.jsx(ue,{}),a.jsx("ambientLight",{intensity:.4}),a.jsx("spotLight",{position:[5,5,5],angle:90,penumbra:1,decay:0,intensity:1}),a.jsx("pointLight",{decay:1,intensity:2}),a.jsx(Te,{position:[0,0,0],sphereProps:m,spiralLinesProps:M,particlesProps:f})]}),n&&a.jsx("div",{className:E.controlsOverlay,children:a.jsx(Ne,{showControls:n,sphereMutableProps:l,onSphereMutablePropsChange:p,spiralLinesProps:d,onSpiralLinesPropsChange:b,particlesProps:C,onParticlesPropsChange:o})}),t&&s&&a.jsx("div",{className:E.skyboxLoadingOverlay,children:a.jsx(me,{})})]})};export{Ae as default};
